<html>
    <head>
	<link type="text/css" href="/public/css/style.css" rel="stylesheet"/>
	<script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
    </head>
    <body>
	<p>Whoopie starting again!</p>
	<img src="/public/img/sun.png" width=50px height=50px />
	<button id="getBoards" data-url="/">getBoards</button>
	<p id="results"></p>
    </body>

    <script type="text/javascript">
     xhr = new XMLHttpRequest();
     xhr.onreadystatechange = function () {
	 var DONE = 4;
	 var OK = 200;
	 if (xhr.readyState === DONE) {
	     if (xhr.status === OK) { 
		 console.log(xhr.responseText);
	     } else {
		 console.log('Error: ' + xhr.status);
	     }
	 }
     };

     var getBoards = document.getElementById('getBoards'),
	 results = document.getElementById('results'),
	 toReadyStateDescription = function (state) {
	     switch(state) {
		 case 0:
		     return 'UNSENT';
		 case 1:
		     return 'OPENED';
		 case 2:
		     return 'HEADERS_RECEIVED';
		 case 3:
		     return 'LOADING';
		 case 4:
		     return 'DONE';
		 default:
		     return '';
	     }
	 };

     getBoards.addEventListener('click', function (e) {
	 console.log("getBoards pressed");
	 var oReq = new XMLHttpRequest();
	 oReq.onload = function(e) {
	     console.log("request in state onload");
	     results.innerHTML = JSON.parse(e.target.response).message;
	 };
	 oReq.onreadystatechange = function() {
	     var readyState = toReadyStateDescription(oReq.readyState);
	     console.log("request ready state change: ", readyState);
	 }; 
	     oReq.open('GET', e.target.dataset.url, true);
	     oReq.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
	     oReq.send();
     });
    </script>

</html>
